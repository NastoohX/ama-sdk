<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for amd.github.io -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="cb638ba1-8bc4-44a0-9338-632d4dc19be6" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for amd.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>Card Management &mdash; AMD AMA 0.3 (July Early Access) documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Software Migration Considerations" href="migration.html" />
    <link rel="prev" title="C API Programming Guide" href="c_apis.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="index.html" class="icon icon-home"> AMD AMA
            <img src="_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.3
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_on_prem.html">On Premises</a></li>
<li class="toctree-l1"><a class="reference internal" href="virtualization.html">Virtualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Tutorials and Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Guides</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="package_feed.html">Package Feed Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_ffmpeg.html">Using FFmpeg</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_gstreamer.html">Using Gstreamer</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning_video_quality.html">Tuning Video Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="tuning_pipeline_latency.html">Tuning Latency of Transcode Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="managing_compute_resources.html">Managing Compute Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="c_apis.html">C API Programming Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Card Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mautil-maflash-and-mamgmt">mautil, maflash and mamgmt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xrmadm-and-xrmd">xrmadm and xrmd</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#card-and-device-identifiers">Card and Device Identifiers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#device-bdf-mautil">Device BDF (mautil)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#device-bdf-mamgmt">Device BDF (mamgmt)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bus-id">Bus ID</a></li>
<li class="toctree-l3"><a class="reference internal" href="#firmware-version-number">Firmware Version Number</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#checking-system-status-mautil">Checking System Status - mautil</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-device-status">Checking Device Status</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-device-configuration-mamgmt">Checking Device Configuration - mamgmt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#programming-a-device">Programming a Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="#checking-resource-utilization">Checking Resource Utilization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migration Path</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Video Products</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://xilinx.github.io/video-sdk/v3.0/index.html">U30</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">AMD AMA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Card Management</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="card-management">
<h1>Card Management<a class="headerlink" href="#card-management" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#overview" id="id1">Overview</a></p></li>
<li><p><a class="reference internal" href="#card-and-device-identifiers" id="id2">Card and Device Identifiers</a></p></li>
<li><p><a class="reference internal" href="#checking-system-status-mautil" id="id3">Checking System Status - mautil</a></p></li>
<li><p><a class="reference internal" href="#checking-device-status" id="id4">Checking Device Status</a></p></li>
<li><p><a class="reference internal" href="#checking-device-configuration-mamgmt" id="id5">Checking Device Configuration - mamgmt</a></p></li>
<li><p><a class="reference internal" href="#programming-a-device" id="id6">Programming a Device</a></p></li>
<li><p><a class="reference internal" href="#checking-resource-utilization" id="id7">Checking Resource Utilization</a></p></li>
</ul>
</div>
<section id="overview">
<h2><a class="toc-backref" href="#id1">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The AMD AMA Video SDK builds on the Xilinx Resource Manager (XRM) to interface with AMD video acceleration cards. The AMD AMA Video SDK includes the <code class="docutils literal notranslate"><span class="pre">mautil</span></code>, <code class="docutils literal notranslate"><span class="pre">mamgmt</span></code> , <code class="docutils literal notranslate"><span class="pre">maflash</span></code> and <code class="docutils literal notranslate"><span class="pre">xrmadm</span></code> command line tools for card installation, upgrade, and management.</p>
<section id="mautil-maflash-and-mamgmt">
<h3>mautil, maflash and mamgmt<a class="headerlink" href="#mautil-maflash-and-mamgmt" title="Permalink to this headline">¶</a></h3>
<p>The AMD Board Utility (<code class="docutils literal notranslate"><span class="pre">mautil</span></code>), the AMD Flash Utility, (<code class="docutils literal notranslate"><span class="pre">maflas</span></code>) and the AMD Board Management Utility (<code class="docutils literal notranslate"><span class="pre">mamgmt</span></code>) are standalone command line tools used to query, flash and administer AMD acceleration cards.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mautil</span></code> is used to examine and identify the installed accelerator card(s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maflash</span></code> is used to flash card(s) firmware.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mamgmt</span></code> is used to examine devices, reset and administer the installed accelerator card(s).</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">mautil</span></code>, <code class="docutils literal notranslate"><span class="pre">maflash</span></code> and <code class="docutils literal notranslate"><span class="pre">mamgmt</span></code> commands target one device at a time using a PCIe BDF (Bus:Device.Function) identifier. The BDF notation works as follows:</p>
<ul class="simple">
<li><p>PCI Domain number, often padded using leading zeros to four digits</p></li>
<li><p>A colon (:)</p></li>
<li><p>PCI Bus number in hexadecimal, often padded using a leading zeros to two or four digits</p></li>
<li><p>A colon (:)</p></li>
<li><p>PCI Device number in hexadecimal, often padded using a leading zero to two digits . Sometimes this is also referred to as the slot number.</p></li>
<li><p>A decimal point (.)</p></li>
<li><p>PCI Function number in hexadecimal.</p></li>
</ul>
</section>
<section id="xrmadm-and-xrmd">
<h3>xrmadm and xrmd<a class="headerlink" href="#xrmadm-and-xrmd" title="Permalink to this headline">¶</a></h3>
<p>XRM is the software which manages the hardware accelerators available in the system. The XRM daemon (<code class="docutils literal notranslate"><span class="pre">xrmd</span></code>) is a background process supporting reservation, allocation, and release of hardware acceleration resources. The XRM <code class="docutils literal notranslate"><span class="pre">xrmadm</span></code> command line tool is used to interact with the XRM daemon (<code class="docutils literal notranslate"><span class="pre">xrmd</span></code>) in order to check status and generate resource utilization reports.</p>
<p>For more details about the XRM commands specific to the AMD AMA Video SDK refer to the <a class="reference internal" href="managing_compute_resources.html#xrm-reference"><span class="std std-ref">XRM Command Reference Guide</span></a>.</p>
</section>
</section>
<section id="card-and-device-identifiers">
<h2><a class="toc-backref" href="#id2">Card and Device Identifiers</a><a class="headerlink" href="#card-and-device-identifiers" title="Permalink to this headline">¶</a></h2>
<section id="device-bdf-mautil">
<span id="device-bdf"></span><h3>Device BDF (mautil)<a class="headerlink" href="#device-bdf-mautil" title="Permalink to this headline">¶</a></h3>
<p>The list of all installed AMD AMA Video SDK compatible devices, including their BDF is obtained with the <code class="docutils literal notranslate"><span class="pre">mautil</span> <span class="pre">examine</span></code> command.</p>
<p>For example, the command below detected 2 devices and lists their BDFs:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mautil examine
List of available devices:
0000:01:00.0
0000:02:00.0
Info: No action taken, no reports given.
Info: Use --help to check cmd options to use for reports
</pre></div>
</div>
<p>The last device listed has BDF of 0000:02:00.0, which describes Domain 0, Bus 02, Device 00, Function 0.</p>
</section>
<section id="device-bdf-mamgmt">
<span id="device-management-bdf"></span><h3>Device BDF (mamgmt)<a class="headerlink" href="#device-bdf-mamgmt" title="Permalink to this headline">¶</a></h3>
<p>The list of all installed AMD AMA Video SDK compatible devices, including their BDF can also be obtained with the <code class="docutils literal notranslate"><span class="pre">mamgmt</span> <span class="pre">examine</span></code> command.</p>
<p>For example, the command below detected 2 devices and lists their BDF designations:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ mamgmt examine


  List of available devices:
  0000:01:00.0
  0000:02:00.0
  Info: No action taken, no reports given.
  Info: Use --help to check cmd options to use for reports
</pre></div>
</div>
<p>The last device listed has BDF of 0000:02:00.0, which describes Domain 0, Bus 2, Device 00, Function 0.</p>
</section>
<section id="bus-id">
<span id="device-device-id"></span><h3>Bus ID<a class="headerlink" href="#bus-id" title="Permalink to this headline">¶</a></h3>
<p>You can look-up the PCIe bus ID of a device through the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cat /sys/class/misc/ama_transcoder{x}/bus_id
</pre></div>
</div>
<p>, where x is a number between 0 to total number of devices minus 1.</p>
<p class="rubric">Example</p>
<ul>
<li><p>Bus id of /sys/class/misc/ama_transcoder0 is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ cat /sys/class/misc/ama_transcoder0/bus_id
  0000:01:00.0
</pre></div>
</div>
</li>
<li><p>This can be verified by <code class="docutils literal notranslate"><span class="pre">mautil</span> <span class="pre">examine</span></code> command.</p></li>
</ul>
</section>
<section id="firmware-version-number">
<span id="card-version-number"></span><h3>Firmware Version Number<a class="headerlink" href="#firmware-version-number" title="Permalink to this headline">¶</a></h3>
<p>To look-up the version number of each installed firmware, proceed as follows:</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>cat /sys/class/misc/ama_transcoder0/version_information
</pre></div>
</div>
<p>It should return:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;&lt;&lt;Version Info&gt;&gt;&gt;
ZSP Version = 0.1.15
SC Version = 9.7.3
eSecure Version = 1.0.0
PCIe FW Version = 2.1.0
PCIe CTRL Patch Version = 1.0.2
PCIe PHY Patch A Version = 1.0.0
</pre></div>
</div>
</div></blockquote>
</section>
</section>
<section id="checking-system-status-mautil">
<span id="examining-cards"></span><h2><a class="toc-backref" href="#id3">Checking System Status - mautil</a><a class="headerlink" href="#checking-system-status-mautil" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mautil</span></code> commands provides useful details about your environment and can be used to ensure that your cards and devices are properly detected.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mautil -d &lt;BDF&gt; command, where command is one of the following:
   examine    - Status of the system and device.
   reset      - Resets the given device
   validate   - Validates the basic shell acceleration functionality
</pre></div>
</div>
<p>Note that <code class="docutils literal notranslate"><span class="pre">reset</span></code> and <code class="docutils literal notranslate"><span class="pre">validate</span></code> sub-commands are to be executed from VM instances only. Executing these sub-commands from the host leads to unpredictable results. Furthermore, <code class="docutils literal notranslate"><span class="pre">reset</span></code> sub-command has to be executed with root privileges.</p>
<p>For more details on <code class="docutils literal notranslate"><span class="pre">examine</span></code> command, see <a class="reference internal" href="#device-details"><span class="std std-ref">Checking Device Status</span></a>.</p>
</section>
<section id="checking-device-status">
<span id="device-details"></span><h2><a class="toc-backref" href="#id4">Checking Device Status</a><a class="headerlink" href="#checking-device-status" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mautil</span> <span class="pre">examine</span> <span class="pre">-d</span> <span class="pre">&lt;BDF&gt;</span> <span class="pre">--report</span> <span class="pre">&lt;type&gt;</span></code> commands provides additional details about the status of each AMD AMA Video SDK compatible device installed.</p>
<p>The –report (or -r) switch is used to view specific report(s) of interest:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">electrical</span></code>: Reports Electrical and power sensors present on the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">device-hw</span></code>: Provides information on the device’s hardware</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">error-cnt</span></code>: Reports on device’s error counter</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">flash-info</span></code>: Prints device’s flash information</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">memory</span></code>: Reports memory topology of the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pcie-info</span></code>: PCIe information of the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thermal</span></code>: Reports thermal sensors present on the device</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">all</span></code>: Prints all the known status</p></li>
</ul>
<p>These reports can also be generated in a JSON file, by adding <code class="docutils literal notranslate"><span class="pre">--format</span> <span class="pre">JSON</span> <span class="pre">-o</span> <span class="pre">&lt;filename&gt;</span></code> to the <code class="docutils literal notranslate"><span class="pre">mautil</span> <span class="pre">examine</span></code> command.</p>
<p>An example usage for thermal and electrical reports, for the device with BDF 0000:02:00.0 is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mautil examine -r thermal electrical -d 0000:02:00.0

---------------------------------
1/1 [0000:01:00.0] : MA35 Device
---------------------------------
MA35 Thermal Info:
Device Temperature:
  id: ma35_temp_s2 [85 C]
Board Temperature:
  id: board_temp [44 C]
MA35 Electrical Info:
Device Electrical Info:
  id: aux [732 mV]
  id: ddr0 [868 mV]
  id: ml_engine [747 mV]
  id: enc [748 mV]
Board Electrical Info:
  id: 3V PEX Voltage [3304 mV]
  id: 3V AUX Voltage [3320 mV]
  id: 12V PEX Voltage [12040 mV]
  id: 3V PEX Current [293 mA]
  id: 3V AUX Current [93 mA]
  id: 12V PEX Current [426 mA]
  id: board_power [6405 mW]
</pre></div>
</div>
</section>
<section id="checking-device-configuration-mamgmt">
<span id="device-status"></span><h2><a class="toc-backref" href="#id5">Checking Device Configuration - mamgmt</a><a class="headerlink" href="#checking-device-configuration-mamgmt" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mamgmt</span></code> provides administrative commands for managing the installed devices. In addition to commands that are provided by <a class="reference internal" href="#device-details"><span class="std std-ref">mautil</span></a>, <code class="docutils literal notranslate"><span class="pre">mamgmt</span></code> also allows for managing Virtual Functions (VF) on a device:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mamgmt -d &lt;BDF&gt; cmmand, where command is one of the following:
  examine      - Status of the system and device
  numvfs       - Create a VF. Or destroys the active VF
  reset        - Resets the given device
</pre></div>
</div>
<p>An example usage for all available reports on 0000:01:00.1 is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mamgmt examine -d 0000:01:00.0 -r all
System Configuration
  OS Name              : Linux
  Release              : 5.15.0-60-generic
  Version              : #66-Ubuntu SMP Fri Jan 20 14:29:49 UTC 2023
  Machine              : x86_64
  CPU Cores            : 24
  Memory               : 63450 MB
  glibc                : 2.35


Devices present
  device bdf: [0000:04:00.0]
  device bdf: [0000:01:00.0]
  device bdf: [0000:02:00.0]
  device bdf: [0000:03:00.0]
  device bdf: [0000:02:00.1]

---------------------------------
1/1 [0000:01:00.0] : MA35 Device
---------------------------------

Memory Bandwidths:
         Tag                 Current (MBps)
  s2_dfi_w_MBps             : 0
  s2_dfi_r_MBps             : 0
  s2_axi_w_MBps             : 0
  s2_axi_r_MBps             : 0
  s1_dfi_w_MBps             : 0
  s1_dfi_r_MBps             : 0
  s1_axi_w_MBps             : 0
  s1_axi_r_MBps             : 0

Pcie Info:
  Vendor                 : 0x10ee
  Device                 : 0x5070
  PCIe                   : 16GT/s, Width 4

MA35 Thermal Info:
Device Temperature:
  id: Device Temp [114 C]
Board Temperature:
  id: board_temp [59 C]

MA35 Electrical Info:
Device Electrical Info:
  id: aux [740 mV]
  id: ddr0 [868 mV]
  id: ml_engine [750 mV]
  id: enc [747 mV]
Board Electrical Info:
  id: 3V PEX Voltage [3304 mV]
  id: 3V AUX Voltage [3296 mV]
  id: 12V PEX Voltage [12216 mV]
  id: 3V PEX Current [266 mA]
  id: 3V AUX Current [80 mA]
  id: 12V PEX Current [1026 mA]
  id: board_power [13676 mW]

Device Hardware Info:
Device uptime (sec):5620
Device Firmware Info:
  PciePhyPatch:  1.0.0
  PcieCtlPatch:  1.0.2
  PCIe:  2.1.0
  eSecure:  1.0.0
  SC:  9.7.2
  ZSP:  0.1.13
Device Threshold Info:
  shutdown_temp_C:  110
  max_operating_temp_C:  105
  threshold_temp_C:  85
Device Hardware Info:
  oem_id:  0xe78
  sku_number:  01
  part_number:  05105-01
  Product_Name:  ALVEO MA35D ENG
  Product_Revision:  B01
  Product_SN:  51051A32C24K
  Processor_Type:  VPU (Video Processing Unit)

Device Flash Info:
  PciePhyPatch:  1.0.0
  PcieCtlPatch:  1.0.2
  PCIe:  2.1.0
  eSecure:  1.0.0
  SC:  9.7.2
  ZSP:  0.1.13

MA35 Error Counter Info:
         Tag                 Uncorrectable       Correctable
    THS2_axi_sram            0                   0
    THS1_axi_sram            0                   0
    ddr_ch7                  0                   0
    ddr_ch6                  0                   0
    ddr_ch3                  0                   0
    ddr_ch2                  0                   0
    ddr_ch1                  0                   0
    ddr_ch5                  0                   0
    ddr_ch0                  0                   0
    ddr_ch4                  0                   0
    pcie                     0                   0
</pre></div>
</div>
<p>An example usage to reset device 0000:01:00.0 is:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mamgmt reset -d 0000:01:00.0
Are you sure you wish to proceed? [Y/n]: y
****************************************************
Reset command completed
****************************************************
</pre></div>
</div>
<p>To create and destroy a VF device, issue the following commands, respectively:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo mamgmt -d &lt;BDF&gt; numvfs -v 1 # Create VF device
$ sudo mamgmt -d &lt;BDF&gt; numvfs -v 0 # Destroy VF device
</pre></div>
</div>
</section>
<section id="programming-a-device">
<span id="device-prog"></span><h2><a class="toc-backref" href="#id6">Programming a Device</a><a class="headerlink" href="#programming-a-device" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">maflash`</span></code> utility provides means of programming, verifying and reading flash images from a target device.
To perform any of <code class="docutils literal notranslate"><span class="pre">maflash</span></code> sub-commands, specify the &lt;BDF&gt; of the device, along with the desired image type:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo maflash &lt;sub-command&gt; -d &lt;BDF&gt; program --flash-type &lt;flash type&gt; --image &lt;path_to_flash_image&gt;
    -d, --device       - The Bus:Device.Function (e.g., 0000:01:00.0) device of interest.
    --image            - Specifies path to the firmware image of the device.
    --flash-type       - Specify the flash section to program. Valid values:
                            # ZSP
                            # spi_flash
                            # SC
</pre></div>
</div>
<p>, where sub-command is one of:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>read                - To read an existing image
program             - To flash an image
verify              - To verify proper image flashing
</pre></div>
</div>
<p>For example, the following command programs the ZSP system controller with zsp_firmware_packed_v015.bin flash image.:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo /opt/amd/ma35/bin/maflash program -d 0000:01:00.0 --flash-type ZSP --image zsp_firmware_packed_v0115.bin
Device-BDF --&gt; 0000:01:00.0
EraseFlash Started..
9%  18%  27%  36%  45%  54%  63%  72%  81%  90%  100%

WriteFlash Started, please Wait..
flash_progress:
10%  20%  30%  40%  50%  60%  70%  80%  90%  100%

status: PASS
</pre></div>
</div>
<p>To verify proper programming, issue the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo /opt/amd/ma35/bin/maflash verify -d 0000:01:00.0 --flash-type ZSP --image zsp_firmware_packed_v0115.bin
Device-BDF --&gt; 0000:01:00.0
status: PASS
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With regard to <code class="docutils literal notranslate"><span class="pre">maflash</span> <span class="pre">read</span></code>, as the image read is the entire flash bank, the output file will not be the same as the original flash file.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For details on flashing Satellite Controller (SC), refer to <a class="reference internal" href="getting_started_on_prem.html#flash-firmware"><span class="std std-ref">Flash Firmware</span></a> section.</p>
</div>
</section>
<section id="checking-resource-utilization">
<h2><a class="toc-backref" href="#id7">Checking Resource Utilization</a><a class="headerlink" href="#checking-resource-utilization" title="Permalink to this headline">¶</a></h2>
<p>Start xrmd daemon:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo -s source /opt/amd/ma35/scripts/setup_xrmd.sh
</pre></div>
</div>
<p>Note that this command should be run only once per boot.</p>
<p>To check the current loading of all the devices in your system, use the following command:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>xrmadm /opt/amd/ma35/scripts/list_cmd.json
</pre></div>
</div>
<p>This will generate a report in JSON format containing the load information for all the compute unit (CU) resources. The report contains a section for each device in the system. The device sections contain sub-sections for each of the CUs (decoder, scaler, lookahead, encoder) in that device. For example, the load information for the encoder on device 0 may look as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&quot;device_0&quot;: {
  ...
  &quot;cu_2&quot;: {
       &quot;cuId         &quot;: &quot;2&quot;,
       &quot;cuType       &quot;: &quot;IP Kernel&quot;,
       &quot;kernelName   &quot;: &quot;encoder&quot;,
       &quot;kernelAlias  &quot;: &quot;ENCODER_TYPE1_AMA&quot;,
       &quot;instanceName &quot;: &quot;encoder_1&quot;,
       &quot;cuName       &quot;: &quot;encoder:encoder_1&quot;,
       &quot;kernelPlugin &quot;: &quot;&quot;,
       &quot;maxCapacity  &quot;: &quot;497664000&quot;,
       &quot;numChanInuse &quot;: &quot;0&quot;,
       &quot;usedLoad     &quot;: &quot;0 of 1000000&quot;,
       &quot;reservedLoad &quot;: &quot;0 of 1000000&quot;,
       &quot;resrvUsedLoad&quot;: &quot;0 of 1000000&quot;
   },
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">usedLoad</span></code> value indicates how much of that resource is currently being used. The value will range from 0 (nothing running) to 1000000 (fully loaded). The <code class="docutils literal notranslate"><span class="pre">reservedLoad</span></code> value indicates how much of that resource is being reserved using XRM. The <code class="docutils literal notranslate"><span class="pre">resrvUsedLoad</span></code> value indicates how much of the reserved load is actually being used.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<span class="target" id="card-reset"></span></section>
</section>


           </div>
          </div>
          
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="c_apis.html" class="btn btn-neutral float-left" title="C API Programming Guide" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="migration.html" class="btn btn-neutral float-right" title="Software Migration Considerations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on October 02, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>