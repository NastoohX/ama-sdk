<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
<!-- OneTrust Cookies Consent Notice start for amd.github.io -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="cb638ba1-8bc4-44a0-9338-632d4dc19be6" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for amd.github.io -->
<!-- Google Tag Manager -->
<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
<!-- End Google Tag Manager -->
  <title>GStreamer Introductory Tutorials &mdash; AMD AMA 0.0 (Pre-release) documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/_static/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="XMA Examples for the AMD AMA Video SDK" href="../xma/xma_apps.html" />
    <link rel="prev" title="Video Quality Examples" href="../ffmpeg/quality_analysis.html" /> 
</head>

<body class="wy-body-for-nav">

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
<!-- End Google Tag Manager --> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
            <a href="../../index.html" class="icon icon-home"> AMD AMA
            <img src="../../_static/xilinx-header-logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started_on_prem.html">On Premises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../virtualization.html">Virtualization</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../examples.html">Tutorials and Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../ffmpeg/tutorials.html">FFmpeg Introductory Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ffmpeg/quality_analysis.html">FFmpeg Video Quality</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Gstreamer Introductory Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#environment-setup">Environment Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-gstreamer-examples">Simple GStreamer Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#decode-only">Decode only</a></li>
<li class="toctree-l4"><a class="reference internal" href="#encode-only">Encode only</a></li>
<li class="toctree-l4"><a class="reference internal" href="#transcode-with-multiple-resolution-outputs">Transcode with Multiple-Resolution outputs</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../xma/xma_apps.html">C-Based Applications</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Guides</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../package_feed.html">Package Feed Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_ffmpeg.html">Using FFmpeg</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../using_gstreamer.html">Using Gstreamer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tuning_video_quality.html">Tuning Video Quality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tuning_pipeline_latency.html">Tuning Latency of Transcode Pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../managing_compute_resources.html">Managing Compute Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../c_apis.html">C API Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../card_management.html">Card Management</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: black" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">AMD AMA</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../examples.html">Tutorials and Examples</a> &raquo;</li>
      <li>GStreamer Introductory Tutorials</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gstreamer-introductory-tutorials">
<span id="gstreamer-tutorials"></span><h1>GStreamer Introductory Tutorials<a class="headerlink" href="#gstreamer-introductory-tutorials" title="Permalink to this headline">¶</a></h1>
<p>This page provides tutorials on how to use GStreamer with the AMD AMA Video SDK. The complete reference guide for the GStreamer version included in the AMD AMA Video SDK can be found <a class="reference internal" href="../../using_gstreamer.html"><span class="doc">here</span></a>.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#environment-setup" id="id1">Environment Setup</a></p></li>
<li><p><a class="reference internal" href="#simple-gstreamer-examples" id="id2">Simple GStreamer Examples</a></p>
<ul>
<li><p><a class="reference internal" href="#decode-only" id="id3">Decode only</a></p></li>
<li><p><a class="reference internal" href="#encode-only" id="id4">Encode only</a></p></li>
<li><p><a class="reference internal" href="#transcode-with-multiple-resolution-outputs" id="id5">Transcode with Multiple-Resolution outputs</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="environment-setup">
<h2><a class="toc-backref" href="#id1">Environment Setup</a><a class="headerlink" href="#environment-setup" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p>The AMD AMA Video SDK version of FFmpeg, Gstreamer and XMA applications can be found in the /opt/amd/ma35/bin folder of your system. If this folder is not present, install the required packages:</p>
<p>See <a class="reference internal" href="../../getting_started_on_prem.html"><span class="doc">On Premises</span></a></p>
</li>
<li><p>Start the the xrmd deamon</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>sudo -s source /opt/amd/ma35/scripts/setup_xrmd.sh
</pre></div>
</div>
<p>Note that this command should be run only once per boot.</p>
</li>
<li><p>Configure the environment to use the AMD AMA Video SDK. This a mandatory step for all XMA applications:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>source /opt/amd/ma35/scripts/setup.sh
</pre></div>
</div>
</li>
</ol>
<p>The setup script exports important environment variables and ensures proper execution environment for AMD AMA Video SDK.</p>
<p>Sourcing the setup script should be performed each time you open a new terminal on your system. This is required for the environment to be correctly configured.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It may be required to execute the following to ensure a proper working setup:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ -z &quot;$preset_slow_vq&quot; ] &amp;&amp; echo -e &quot;\nexport preset_slow_vq=&#39; -expert_options vceVertSearchRangeP=64,vceVertSearchRangeBr=64,vceVertSearchRangeBd=64,vcePsyFactorFixedPoint=179&#39;&quot; | sudo tee -a /opt/amd/ma35/scripts/setup.sh &amp;&amp; echo &quot;export preset_slow_metrics=&#39; -expert_options vceVertSearchRangeP=64,vceVertSearchRangeBr=64,vceVertSearchRangeBd=64,rdoqEnableMask=0xf,rdoqMaskI=0xffff,rdoqMaskP=0xffff,rdoqMaskBr=0xffff,rdoqMaskBd=0xffff&#39;&quot; | sudo tee -a /opt/amd/ma35/scripts/setup.sh &amp;&amp; source /opt/amd/ma35/scripts/setup.sh
</pre></div>
</div>
</div>
</section>
<section id="simple-gstreamer-examples">
<h2><a class="toc-backref" href="#id2">Simple GStreamer Examples</a><a class="headerlink" href="#simple-gstreamer-examples" title="Permalink to this headline">¶</a></h2>
<p>By default, all the example scripts use the filesink plug-in and write the output files into the /tmp directory.</p>
<p>Some of the examples read or write RAW files from disk (encode-only or decode-only pipelines). There is a chance that due to the massive bandwidth required for operating on these RAW files, you will notice a drop in FPS; this is not due to the AMD AMA Video SDK but the disk speeds. We recommend reading/writing from <code class="docutils literal notranslate"><span class="pre">/dev/shm</span></code> which is a RAM disk.</p>
<p>Most of the scripts allow to use the fakesink plug-in which only displays performance numbers and will not write outputs to disk. This is done by setting the “fakesink” argument to 1.</p>
<p>Each script contains error checks before passing arguments to GStreamer pipeline command to help users avoid giving incorrect arguments.</p>
<p>Most of the example scripts included in this directory take H.264 input streams. To use H.265 input streams, update the scripts to use the <code class="docutils literal notranslate"><span class="pre">h265parse</span></code> GStreamer plug-in instead of <code class="docutils literal notranslate"><span class="pre">h264parse</span></code>.</p>
<p>For brevity purposes, explanations of the GStreamer element properties are not repeated after they have been explained once. The detailed explanation of the each GStreamer pipeline element property can be obtained by using <code class="docutils literal notranslate"><span class="pre">gst-inspect-1.0</span> <span class="pre">&lt;element</span> <span class="pre">name&gt;</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">gst-inspect-1.0</span> <span class="pre">ama_av1enc</span></code>).</p>
<section id="decode-only">
<span id="gstreamer-decode-only"></span><h3><a class="toc-backref" href="#id3">Decode only</a><a class="headerlink" href="#decode-only" title="Permalink to this headline">¶</a></h3>
<p><strong>Command Line</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gst-launch-1.0 filesrc location=&lt;INPUT&gt; ! h264parse ! ama_h264dec ! capsfilter &#39;caps=video/x-raw(memory:AMAMemory),format=NV12&#39; !  ama_download ! filesink location=/tmp/h264.nv12
</pre></div>
</div>
<p>Explanation of the pipeline elements and their properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">gst-launch-1.0</span></code></p>
<ul>
<li><p>The GStreamer application, which is provided by Xilinx, and moved to the top of the PATH when you sourced the setup.sh script</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">filesrc</span> <span class="pre">location</span></code></p>
<ul>
<li><p>Location of the file to read</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">h264parse</span></code></p>
<ul>
<li><p>Parses H.264 streams</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ama_h264dec</span></code></p>
<ul>
<li><p>GStreamer plug-in that provides functionality to decode H.264 encoded streams. This plug-in accepts input encoded stream in byte-stream/NALU format only and produces NV12 frames.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">capsfilter</span></code></p>
<ul>
<li><p>Specifies the capabilities of the streams. Note that keyword <code class="docutils literal notranslate"><span class="pre">capsfilter</span></code> is optional.</p></li>
</ul>
</li>
</ul>
</section>
<section id="encode-only">
<span id="gstreamer-encode-only"></span><h3><a class="toc-backref" href="#id4">Encode only</a><a class="headerlink" href="#encode-only" title="Permalink to this headline">¶</a></h3>
<p><strong>Command Line</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gst-launch-1.0 filesrc location=&lt;INPUT&gt; ! rawvideoparse width=1920 height=1080 format=i420 framerate=60/1 ! ama_upload ! ama_h264enc ! h264parse ! filesink location=/tmp/out.h264
</pre></div>
</div>
<p>Explanation of the pipeline elements and their properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ama_h264enc</span></code></p>
<ul>
<li><p>GStreamer plug-in that provides functionality to encode raw bit streams into AVC byte-stream.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">rawvideoparse</span></code></p>
<ul>
<li><p>This element converts unformatted data streams into timestamped raw video frames, with specified resolution, frame rate and pixel format.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">ama_upload</span></code></p>
<ul>
<li><p>This plugin transfer raw video file content from host to the device</p></li>
</ul>
</li>
</ul>
</section>
<section id="transcode-with-multiple-resolution-outputs">
<span id="gstreamer-transcode-and-scale"></span><h3><a class="toc-backref" href="#id5">Transcode with Multiple-Resolution outputs</a><a class="headerlink" href="#transcode-with-multiple-resolution-outputs" title="Permalink to this headline">¶</a></h3>
<p><strong>Command Line</strong>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gst-launch-1.0 filesrc location=&lt;INPUT&gt; ! \
h264parse ! ama_h264dec ! identity eos-after=1200 ! ama_scaler name=s \
s.src_0 ! &#39;video/x-raw(memory:AMAMemory),width=1920,height=1080&#39; ! ama_h265enc bitrate=6000000 ! queue ! filesink location=/tmp/hevc_1080p.hevc \
s.src_1 ! &#39;video/x-raw(memory:AMAMemory),width=1280,height=720&#39; ! ama_av1enc bitrate=2000000 ! queue ! filesink location=/tmp/av1_720p.av1 \
s.src_2 ! &#39;video/x-raw(memory:AMAMemory),width=720,height=480&#39; ! ama_h264enc bitrate=1000000 ! queue ! filesink location=/tmp/h264_480p.h264 \
s.src_3 ! &#39;video/x-raw(memory:AMAMemory),width=360,height=240&#39; ! ama_av1enc bitrate=1000000 ! queue ! filesink location=/tmp/av1_240p.av1
</pre></div>
</div>
<p>Explanation of the pipeline elements and their properties:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">queue</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>The queue will create a new thread on the source pad to decouple the processing on sink and source pad.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">identity</span></code></p>
<blockquote>
<div><ul class="simple">
<li><p>In this usage, forces the insertion of EOS after 1200 buffers.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          
				  
				  <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ffmpeg/quality_analysis.html" class="btn btn-neutral float-left" title="Video Quality Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../xma/xma_apps.html" class="btn btn-neutral float-right" title="XMA Examples for the AMD AMA Video SDK" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2023, Advanced Micro Devices, Inc.
      <span class="lastupdated">Last updated on July 20, 2023.
      </span></p>
  </div>



										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">

													                    <div class="row">
                        <div class="col-xs-24">
                          <p><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a> | <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a> | <a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a> | <a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a> | <a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a> | <a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a> | <a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></p>
                        </div>
                    </div>
												</div>
											</div>
										</div>
										
</br>


  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 <script type="text/javascript">
    $(document).ready(function() {
        $(".toggle > *").hide();
        $(".toggle .header").show();
        $(".toggle .header").click(function() {
            $(this).parent().children().not(".header").toggle(400);
            $(this).parent().children(".header").toggleClass("open");
        })
    });
</script>


</body>
</html>